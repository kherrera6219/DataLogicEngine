(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[123],{2040:function(e,s,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pillars",function(){return l(4969)}])},4969:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return h}});var i=l(5893),t=l(7294),a=l(9008),r=l.n(a),n=l(6153),c=l(1329),d=l(2359);function o(e){let{initialPillarId:s}=e,[l,a]=(0,t.useState)([]),[r,n]=(0,t.useState)(s||""),[o,h]=(0,t.useState)(null),[x,p]=(0,t.useState)(""),[m,u]=(0,t.useState)(!1),[j,g]=(0,t.useState)([]);(0,d.p)(),(0,t.useEffect)(()=>{v()},[]),(0,t.useEffect)(()=>{s&&(n(s),b(s))},[s]);let v=async()=>{try{let e=await fetch("/api/pillars/");if(e.ok){let s=await e.json();a(s)}}catch(e){}},b=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e){u(!0);try{let l=await fetch("/api/pillars/".concat(e,"/expand"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({context_text:s})});if(l.ok){let s=await l.json();h(s),f(e)}else{let e=await l.json();showToast({title:"Error",description:e.error||"Failed to expand pillar",status:"error",duration:5e3})}}catch(e){showToast({title:"Error",description:"An unexpected error occurred",status:"error",duration:5e3})}finally{u(!1)}}},f=async e=>{try{let s=await fetch("/api/pillars/mappings?pillar_id=".concat(e));if(s.ok){let e=await s.json();g(e)}}catch(e){}},y=e=>{n(e),p(""),h(null),e&&b(e)},_=async(e,s,l)=>{try{let i=await fetch("/api/pillars/mappings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source_pillar_id:r,source_sublevel_id:e,target_pillar_id:s,target_sublevel_id:l,mapping_type:"related_to",strength:.7,bidirectional:!0})});if(i.ok)showToast({title:"Success",description:"Mapping created successfully",status:"success",duration:3e3}),f(r);else{let e=await i.json();showToast({title:"Error",description:e.error||"Failed to create mapping",status:"error",duration:5e3})}}catch(e){showToast({title:"Error",description:"An unexpected error occurred",status:"error",duration:5e3})}},N=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e&&Array.isArray(e)&&0!==e.length?(0,i.jsx)("div",{children:e.map(e=>(0,i.jsxs)("div",{style:{marginLeft:"".concat(20*s,"px"),marginBottom:"8px"},children:[(0,i.jsxs)("div",{className:"d-flex align-items-center",children:[(0,i.jsx)(c.Ct,{color:0===s?"primary":1===s?"info":"secondary",children:e.id}),(0,i.jsx)(c.xv,{ml:2,fontWeight:0===s?"bold":"normal",children:e.label||e.name}),o&&o.related_pillars&&o.related_pillars.length>0&&(0,i.jsx)(c.Lt,{className:"ms-auto",title:"Map to...",variant:"outline-secondary",size:"sm",children:o.related_pillars.map(s=>(0,i.jsxs)("div",{className:"dropdown-item",children:[(0,i.jsx)("strong",{children:s.pillar_id}),s.mappings&&s.mappings.map(l=>(0,i.jsxs)(c.zx,{size:"sm",variant:"link",className:"d-block text-start",onClick:()=>_(e.id,s.pillar_id,l.target_sublevel),children:["Map to ",l.target_sublevel]},"".concat(l.target_sublevel)))]},s.pillar_id))})]}),e.description&&(0,i.jsx)(c.xv,{fontSize:"sm",color:"gray.600",ml:3,children:e.description}),e.sublevels&&N(e.sublevels,s+1)]},e.id))}):(0,i.jsx)(c.xv,{color:"gray.500",ml:4*s,children:"No sublevels defined"})};return(0,i.jsx)("div",{children:(0,i.jsxs)(c.Zb,{className:"mb-4",children:[(0,i.jsx)(c.Zb.Header,{children:(0,i.jsx)(c.Zb.Title,{children:"Knowledge Pillar Dynamic Mapping"})}),(0,i.jsxs)(c.Zb.Body,{children:[(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)(c.__,{htmlFor:"pillarSelect",children:"Select Pillar Level:"}),(0,i.jsx)(c.Lt,{title:r||"Select a Pillar",id:"pillarSelect",children:l.map(e=>(0,i.jsxs)(c.Lt.Item,{onClick:()=>y(e.id),children:[e.id,": ",e.label||e.name]},e.id))})]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)(c.__,{htmlFor:"contextText",children:"Context for Expansion:"}),(0,i.jsx)(c.gx,{id:"contextText",value:x,onChange:e=>p(e.target.value),placeholder:"Enter text to provide context for dynamic mapping expansion...",rows:4}),(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsx)(c.zx,{onClick:()=>{r?b(r,x):showToast({title:"Warning",description:"Please select a pillar first",status:"warning",duration:3e3})},disabled:!r||m,isLoading:m,children:o?"Re-expand with Context":"Expand with Context"})})]}),o&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("h4",{className:"mb-3",children:["Pillar Structure: ",o.pillar_name," (",o.pillar_id,")"]}),(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h5",{children:"Base Sublevels"}),N(o.base_sublevels)]}),o.expanded_sublevels&&o.expanded_sublevels.length>0&&(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h5",{children:"Expanded Sublevels"}),N(o.expanded_sublevels)]}),o.related_pillars&&o.related_pillars.length>0&&(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h5",{children:"Related Pillars"}),(0,i.jsx)("div",{className:"row",children:o.related_pillars.map(e=>(0,i.jsx)("div",{className:"col-md-6 mb-3",children:(0,i.jsx)(c.Zb,{children:(0,i.jsxs)(c.Zb.Body,{children:[(0,i.jsxs)("div",{className:"d-flex align-items-center mb-2",children:[(0,i.jsx)("h6",{className:"mb-0",children:e.pillar_id}),(0,i.jsx)(c.Ct,{className:"ms-2",color:e.suggested?"warning":"success",children:e.suggested?"Suggested":"Mapped"}),(0,i.jsxs)(c.xv,{className:"ms-auto",children:["Strength: ",e.strength.toFixed(2)]})]}),e.mappings&&e.mappings.length>0&&(0,i.jsxs)("div",{children:[(0,i.jsx)(c.xv,{fontSize:"sm",fontWeight:"bold",children:"Existing Mappings:"}),(0,i.jsx)("ul",{className:"list-unstyled ms-3",children:e.mappings.map((e,s)=>(0,i.jsx)("li",{children:(0,i.jsxs)(c.xv,{fontSize:"sm",children:[e.source_sublevel||"source"," â†’ ",e.target_sublevel||"target",e.mapping_type&&" (".concat(e.mapping_type,")")]})},s))})]}),e.reason&&(0,i.jsx)(c.xv,{fontSize:"sm",fontStyle:"italic",color:"gray.500",mt:1,children:e.reason})]})})},e.pillar_id))})]}),j&&j.length>0&&(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h5",{children:"All Dynamic Mappings"}),(0,i.jsx)("div",{className:"table-responsive",children:(0,i.jsxs)("table",{className:"table table-sm",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Source"}),(0,i.jsx)("th",{children:"Target"}),(0,i.jsx)("th",{children:"Type"}),(0,i.jsx)("th",{children:"Strength"})]})}),(0,i.jsx)("tbody",{children:j.map((e,s)=>(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{children:[e.source.pillar_id,".",e.source.sublevel_id]}),(0,i.jsxs)("td",{children:[e.target.pillar_id,".",e.target.sublevel_id]}),(0,i.jsx)("td",{children:e.mapping_type}),(0,i.jsx)("td",{children:e.strength.toFixed(2)})]},s))})]})})]})]})]})]})})}function h(){let[e,s]=(0,t.useState)([]),[l,a]=(0,t.useState)(!0),[d,h]=(0,t.useState)(null);return(0,t.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/pillars/");if(e.ok){let l=await e.json();s(l)}else h("Failed to fetch pillars")}catch(e){h("Error fetching pillars: ".concat(e.message))}finally{a(!1)}})()},[]),(0,i.jsxs)(n.Z,{children:[(0,i.jsxs)(r(),{children:[(0,i.jsx)("title",{children:"UKG - Knowledge Pillar System"}),(0,i.jsx)("meta",{name:"description",content:"Universal Knowledge Graph Pillar Level Management"})]}),(0,i.jsx)("div",{className:"container-fluid my-4",children:(0,i.jsx)("div",{className:"row",children:(0,i.jsxs)("div",{className:"col-12",children:[(0,i.jsx)("h1",{className:"mb-4",children:"Knowledge Pillar System (Axis 1)"}),d&&(0,i.jsx)("div",{className:"alert alert-danger",children:d}),l?(0,i.jsx)("div",{className:"d-flex justify-content-center my-5",children:(0,i.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,i.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(c.Zb,{className:"mb-4",children:[(0,i.jsx)(c.Zb.Header,{children:(0,i.jsx)(c.Zb.Title,{children:"Pillar Levels Overview"})}),(0,i.jsx)(c.Zb.Body,{children:(0,i.jsx)("div",{className:"row",children:e.map(e=>(0,i.jsx)("div",{className:"col-md-4 col-sm-6 mb-3",children:(0,i.jsx)(c.Zb,{children:(0,i.jsxs)(c.Zb.Body,{children:[(0,i.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,i.jsx)("h5",{className:"mb-1",children:e.id}),(0,i.jsx)(c.zx,{size:"sm",variant:"outline-primary",href:"/pillars?id=".concat(e.id),children:"Map"})]}),(0,i.jsx)(c.xv,{fontWeight:"bold",children:e.label||e.name}),(0,i.jsx)(c.xv,{fontSize:"sm",children:e.description}),(0,i.jsxs)(c.xv,{fontSize:"xs",className:"text-muted mt-2",children:["Sublevels: ",e.sublevels&&Array.isArray(e.sublevels)?e.sublevels.length:Object.keys(e.sublevels||{}).length||0]})]})})},e.id))})})]}),(0,i.jsxs)("div",{className:"my-5",children:[(0,i.jsx)("h2",{className:"mb-4",children:"Dynamic Pillar Mapping Engine"}),(0,i.jsx)(o,{initialPillarId:void 0})]})]})]})})})]})}}},function(e){e.O(0,[945,198,581,764,229,305,888,774,179],function(){return e(e.s=2040)}),_N_E=e.O()}]);