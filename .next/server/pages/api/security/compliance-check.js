"use strict";(()=>{var e={};e.id=85,e.ids=[85],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,i){return i in t?t[i]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,i)):"function"==typeof t&&"default"===i?t:void 0}}})},5913:(e,t,i)=>{i.r(t),i.d(t,{config:()=>l,default:()=>d,routeModule:()=>u});var n={};i.r(n),i.d(n,{default:()=>r});var a=i(1802),s=i(7153),o=i(6249);async function r(e,t){if("POST"!==e.method)return t.status(405).json({success:!1,message:"Method not allowed"});try{let{framework:i,control_id:n}=e.body,a=await c(i,n);return t.status(200).json(a)}catch(e){return t.status(500).json({success:!1,message:"Error performing compliance check",error:e.message})}}async function c(e,t){await new Promise(e=>setTimeout(e,500));let i={"SEC-1.1":{title:"Access Control Policies",description:"The entity defines and documents policies for granting access to entity resources.",status:"compliant",evidence:[{type:"document",name:"Access Control Policy v2.3",date:"2023-05-15"},{type:"audit",name:"Quarterly Access Review",date:"2023-07-01"}],last_tested:"2023-07-01T14:30:00Z"},"SEC-1.2":{title:"User Registration and Provisioning",description:"New users are registered and provisioned in accordance with the access control policies.",status:"compliant",evidence:[{type:"document",name:"User Provisioning Process",date:"2023-04-10"},{type:"log",name:"User Creation Audit Log",date:"2023-07-15"}],last_tested:"2023-07-15T09:45:00Z"},"AVA-2.1":{title:"System Availability Monitoring",description:"The entity monitors the system components and the technology environment to provide consistent availability.",status:"compliant",evidence:[{type:"system",name:"Uptime Monitoring Logs",date:"2023-07-20"},{type:"report",name:"Monthly Availability Report",date:"2023-07-01"}],last_tested:"2023-07-20T11:15:00Z"},"PI-3.1":{title:"Input Data Validation",description:"The entity validates inputs to system components to provide that data is complete, accurate, and valid.",status:"needs_review",evidence:[{type:"code",name:"Input Validation Functions",date:"2023-03-25"},{type:"test",name:"Input Validation Test Cases",date:"2023-03-30"}],last_tested:"2023-04-01T16:20:00Z",remediation:{description:"Update validation for new data formats",due_date:"2023-08-15T00:00:00Z",assignee:"Development Team"}},"CON-4.1":{title:"Data Classification",description:"The entity classifies data based on its criticality and sensitivity and in accordance with its confidentiality policy.",status:"compliant",evidence:[{type:"document",name:"Data Classification Policy",date:"2023-02-10"},{type:"report",name:"Data Classification Audit",date:"2023-06-15"}],last_tested:"2023-06-15T14:10:00Z"},"PRI-5.1":{title:"Privacy Notice",description:"The entity provides notice of its privacy practices to individuals about whom personal information is collected.",status:"compliant",evidence:[{type:"document",name:"Privacy Policy",date:"2023-01-20"},{type:"screenshot",name:"Privacy Notice Implementation",date:"2023-01-25"}],last_tested:"2023-05-10T10:30:00Z"}};if(!t)return{framework:e||"SOC2",total_controls:Object.keys(i).length,compliant:Object.values(i).filter(e=>"compliant"===e.status).length,needs_review:Object.values(i).filter(e=>"needs_review"===e.status).length,non_compliant:Object.values(i).filter(e=>"non_compliant"===e.status).length,controls:Object.keys(i).map(e=>({id:e,title:i[e].title,status:i[e].status}))};let n=i[t];if(!n)throw Error(`Control ${t} not found in framework ${e}`);return{framework:e||"SOC2",control_id:t,...n,timestamp:new Date().toISOString()}}require("next/dist/lib/import-next-warning");let d=(0,o.l)(n,"default"),l=(0,o.l)(n,"config"),u=new a.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/security/compliance-check",pathname:"/api/security/compliance-check",bundlePath:"",filename:""},userland:n})},7153:(e,t)=>{var i;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return i}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(i||(i={}))},1802:(e,t,i)=>{e.exports=i(145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var i=t(t.s=5913);module.exports=i})();